
\documentclass[12pt]{article}  
%The article class is a very basic type of document for writing
\usepackage[margin=1in]{geometry}  %Adjust margins, formatting

\usepackage{amsmath}  
\usepackage{amssymb}  
\usepackage{amsfonts}  
%These packages add commands for useful symbols and fonts and things like that.
%Most of the time, these are all you need.

\usepackage{textcomp, gensymb}  %Gives more symbols, like /degree

\usepackage{amsthm}
\usepackage{adjustbox}
\usepackage{graphicx}

\usepackage{fancyhdr}  %Header and Footer formatting
%\pagestyle{fancy}  
%\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\setlength{\headheight}{15pt}

%Header and Footer Information
\lhead{}  %Replace with your name
\chead{}
\rhead{}  %Replace "Title" with the name of the assignment
\cfoot{\thepage\ of \ref{NumPages}}  %Counts the pages.

\makeatletter        %This provides a total page count as \ref{NumPages}
\AtEndDocument{\immediate\write\@auxout{\string\newlabel{NumPages}{{\thepage}}}}
\makeatother

\usepackage{amsthm}  %This will create the Problem environment

\usepackage[nottoc]{tocbibind} % for table of contents
\usepackage{multicol}
\usepackage{listings}

\setlength{\headheight}{18pt} 

\title{A history of cryptography and cryptanalysis}
\date{\today}
\author{Christopher Colahan\\ Simpson College}

\begin{document}
%title page
\maketitle
\newpage

%table of contents page
\tableofcontents
\listoffigures
\newpage


%main content

%abstract area
\section{Abstract}
Cryptography is used every day to secure private information. Since the invention of the first ciphers
millennia ago, ciphers have been continuously created and broken. The history of cryptography and
cryptanalysis is examined, starting with the transposition and monoalphabetic substitution ciphers of the
ancient Greeks and Romans. Next, frequency analysis is examined as a technique to break monoalphabetic
and polyalphabetic substitution ciphers. Finally, modern cryptography is examined.

\section{Antiquated Cryptography}
\subsection{Transposition Ciphers}
A transposition cipher rearranges the order of the plaintext to create the ciphertext. Two common transposition ciphers are the rail fence and columnar ciphers. In a columnar cipher, the plaintext is written horizontally with a fixed number of characters on each row. The cipher text is obtained by reading each column of the grid \cite{appcrypt}. Transposition ciphers are commonly added to other ciphers to make them more secure.

A technique to determine if a ciphertext is the result of a transposition cipher is to analyze the ciphertext with frequency analysis. If the frequency analysis is performed on the ciphertext and the result is close to the frequency of normal English text, then the cipher is likely to be a transposition cipher \cite{appcrypt}.

\subsection{Monoalphabetic Substitution Ciphers}

A monoalphabetic substitution cipher uses a mapping from one alphabet to another. For convenience converting between the English alphabet and $\mathbb{Z}_{26}$, a mapping $M$: $\{A,B,..., Z\} \rightarrow \mathbb{Z}_{26}$ is defined where $A\mapsto 0$, $B\mapsto 1$, ... $Z\mapsto 25$. Then $M^{-1}$ is defined to be $0\mapsto A$, $1\mapsto B$, ... $25\mapsto Z$.

\subsubsection{Shift Ciphers}
Shift ciphers work by shifting the symbols in the plaintext by an amount. For example, if we are using the English alphabet, then there are $n=26$ possible symbols. We could then choose some $k$, $0<k<n$ for our key. In our notation, this would look like
$$E(p_i,k)=M^{-1}(M(p_i)+k\text{ (mod $n$)}).$$
To get the deciphering function, we shift backwards:
$$D(c_i,k)=M^{-1}(M(c_i)-k\text{ (mod $n$)}).$$

\cite[pg. 98]{absalg}

\subsubsection{Homophonic Substitution Ciphers}
A homophonic substitution cipher is a substitution cipher that maps each symbol to one of more symbols in order to prevent frequency analysis from being used. 

For example, suppose we have 100 symbols $S=\{s_1,s_2,...s_{100}\}$. The letter $e$ would map to approximately 12 or those symbols, but the letter $a$ would only map to about 8 of those symbols.

Before enciphering, each letter is replaced at random with one of the symbols it maps to. This means that each symbol in the ciphertext only appears with a frequency of about 1\% \cite[pg. 53]{codebook}.

Homophonic substitution ciphers can be broken by using the occurrences of various character combinations. For example, $q$ is a rare character so is would be represented by only one symbol. Additionally, $u$ is represented by three symbols. Since $q$ is always followed by $u$, if a symbol in the ciphertext is always followed by one of three symbols, the characters probably represent $q$ and $u$ \cite[pg. 54]{codebook}. Similar techniques can be used to determine the rest of the symbols.

\subsection{Polyalphabetic Substitution Ciphers}
A polyalphabetic substitution cipher uses multiple monoalphabetic substitution ciphers to generate more possibilities for the ciphertext.

\subsubsection{Vigen\`{e}re Cipher}
The vigen\`{e}re cipher uses 26 alphabets to encrypt plaintext. A key is also used that consists of a string of symbols. Given a plaintext symbol $p_i$ and a key symbol $k_j$, the ciphertext symbol $c_i$ is the character in the $i$ column and $j$ row.
Figure \ref{vigsquare} shows the square used for encrypting and decrypting using the Vigen\`{e}re cipher.

\begin{figure}[ht]
	
		\caption{Vigen\`{e}re Square}
		\label{vigsquare}
	
\begin{adjustbox}{max width=\textwidth}
	
	\begin{tabular}{| c || c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c | c ||}
		\hline
		 & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
		\hline\hline
A & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\ \hline
B & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A \\ \hline
C & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B \\ \hline
D & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C \\ \hline
E & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D \\ \hline
F & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E \\ \hline
G & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F \\ \hline
H & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G \\ \hline
I & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H \\ \hline
J & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I \\ \hline
K & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J \\ \hline
L & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K \\ \hline
M & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L \\ \hline
N & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M \\ \hline
O & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N \\ \hline
P & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O \\ \hline
Q & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P \\ \hline
R & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q \\ \hline
S & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R \\ \hline
T & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S \\ \hline
U & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T \\ \hline
V & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U \\ \hline
W & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V \\ \hline
X & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W \\ \hline
Y & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X \\ \hline
Z & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y \\ \hline
	\end{tabular}
\end{adjustbox}


\end{figure}

The Vigen\`{e}re Cipher can be mapped to a function easily by inspecting the table. Notice that every character in the $A$ row is the same as the letter in that column. Additionally, every letter in the $B$ row is offset one from the letter in that column, and the $C$ row is offset by 2, and so on.

By observation, we can see that $M(c_i)=M(p_i)+M(k_j)$. Then the encryption and decryption functions for the Vigen\`{e}re Cipher can be defined as 

$$E(p_i, k_j)=M^{-1}(M(p_i)+M(k_j)\text{ (mod 26)})=c_i.$$
$$D(c_i, k_j)=M^{-1}(M(c_i)-M(k_j)\text{ (mod 26)})=p_i.$$

If we know the length of the key is $n$, then the function could also defined as

$$E(p_i, k_i)=M^{-1}(M(p_i)+M(k_{i\text{ (mod $n$)}}) \text{ (mod 26)})=c_i$$
$$D(c_i, k_i)=M^{-1}(M(c_i)-M(k_{i\text{ (mod $n$)}}) \text{ (mod 26)})=p_i.$$

\subsubsection{One Time Pad}
The one time pad is a special Vigen\`{e}re cipher where
\begin{itemize}
	\item the key is the same length as the plaintext,
	\item the key is random, and
	\item the same key is not used to encrypt two different plain texts.
\end{itemize}
Instead of using a Vigen\`{e}re cipher, modern implementations use the binary XOR operation to combine ciphertext and plaintext since enciphering and deciphering are the same operation and thus much simper.

There is no statistical analysis that can be applied to the ciphertext \cite[pg. 393]{compsec}. This is because if each key is equally likely to occur, then each ciphertext is equally likely to occur. Take, for example, the plaintext $p_1=ATTACK$. If $p_1$ is then encrypted using the key $k_1=ZGRBNL$ then $E(p_1,k_1)=ZZKBPV$. By looking at the Vigen\`{e}re square, a new key $k_2$ can be generated for any $p_2$ of the same length as $p_1$ such that $E(p_2,k_2)=ZZKBPV$. So if the desired plaintext is $p_2=DEFEND$, the corresponding key $k_2=WVFXCS$.

\subsubsection{The Enigma Machine}
The Enigma machine was a German encryption/decryption machine used extensively during World War 2. The Enigma machine consisted of a keyboard, a display, a plugboard, multiple scrambling rotors, and a reflector. When a charcter is entered via the keyboard, an electrical signal is sent first through the plugboard. The plugboard allows pairs of letters to be swapped. Next, the signal goes through the scramblers. Each scrambler acts as a substitution cipher. The reflector then reflects the signal back through the scramblers in the reverse order. Finally, the signal is shown on the corresponding letter on the display. The Enigma machine has a possible 10,000,000,000,000,000 settings \cite[pg. 136]{codebook}.

\subsection{Frequency Analysis}
\subsubsection{Frequency Analysis on Monoalphabetic Substitution Ciphers}
Shift ciphers are easily broken by frequency analysis. Figure \ref{freqchars} the letter frequency from a sample of English text. If a sufficient sample of cipher-text is acquired, The frequency of letters should be a shifted version of Figure \ref{freqchars}.

\begin{figure}[ht]
	\caption{Frequency of Characters in English Text}
	\label{freqchars}
	\begin{center}
		\begin{multicols}{3}
			\begin{tabular}{||c | c||}
				\hline
				Letter & Percentage \\
				\hline\hline
				a & 8.2 \\ 
				\hline
				b & 1.5 \\
				\hline
				c & 2.8 \\
				\hline
				d & 4.3 \\
				\hline
				e & 12.7 \\
				\hline
				f & 2.2 \\
				\hline
				g & 2.0 \\
				\hline
				h & 6.1 \\
				\hline
				i & 7.0 \\
				\hline
			\end{tabular}
			
			\columnbreak
			
			\begin{tabular}{||c | c||}
				\hline
				Letter & Percentage \\
				\hline\hline
				j & 0.2 \\
				\hline
				k & 0.8 \\
				\hline
				l & 4.0 \\
				\hline
				m & 2.4 \\
				\hline
				n & 6.7 \\
				\hline
				o & 7.5 \\
				\hline
				p & 1.9 \\
				\hline
				q & 0.1 \\
				\hline
				r & 6.0 \\
				\hline 
			\end{tabular}
			
			\columnbreak
			
			\begin{tabular}{||c | c||}
				\hline
				Letter & Percentage \\
				\hline\hline
				s & 6.3 \\ 
				\hline 
				t & 9.1 \\
				\hline 
				u & 2.8 \\
				\hline 
				v & 1.0 \\
				\hline 
				w & 2.4 \\
				\hline
				x & 0.2 \\
				\hline
				y & 2.0 \\
				\hline 
				z & 0.1 \\
				\hline 
			\end{tabular}
		\end{multicols}
	\end{center}
	\begin{flushright}
		\cite[pg. 19]{codebook}
	\end{flushright}
\end{figure}

\subsubsection{Frequency Analysis on Polyalphabetic Substitution Ciphers}
Breaking a polyalphabetic cipher is more difficut than a monoalphabetic cipher. For breaking a Vigen\`{e}re cipher, the key length must first be found. To find the key length of a Vigen\`{e}re cipher, all lengths of keys are checked. If the correct length $n$ is chosen, every $n^{th}$ letter taken together will form a frequency distribution similar to that of a monoalphabetic cipher \cite[pg. 72,73]{codebook}. This works because every if the key is length $n$, then every $n^{th}$ character in the key string is the same, thus every $n^{th}$ character in the ciphertext is encrypted using the same alphabet. Once the key length $n$ is found, frequency analysis can be used against all $an$ letters in the ciphertext, for $0\leq a < n$, with each $a$ representing the $a^{th}$ character in the key \cite[pg. 74-76]{codebook}. This process requires the key to be much smaller than the plaintext to be used successfully, so the one-time pad cannot be attacked using this method.

\section{Modern Cryptography}
\subsection{One Way Hashing}
One way hashing is a technique commonly used to store passwords. The idea is to take an input set of plaintext $P$ and map it to an output hash set $C$ using the function $H(p)=c$. Computing $H^{-1}(c)=p$ should be much more computationally difficult that computing $H(p)=c$. To break an ideal one way hash algorithm, the fastest way should be using brute force.

One way hash functions can be used to authentication. If Alice registers a secret key with bob previously, such as a password, Bob can hash and store the key. When Alice wants to verify her identity to Bob, she sends her key to Bob. Bob then hashes the key and if it matches the stored version, then Alice is authenticated. This is safer than Bob storing the key since it is difficult for Bob (or an attacker) to recover the key from the output of the hash function \cite[pg. 52]{appcrypt}

Brute force will always work on a hashing algorithm, but it is often infeasible to complete in any meaningful time. Another attack that may be practical is the birthday attack. The \textit{birthday attack} finds 2 input messages $m$ and $m'$ such that $H(m)=H(m')$ \cite{appcrypt}.

An attack against password hashes is the dictionary attack. Using a large list of common passwords, a table of common passwords and their hashes can be created. The hash of the unkown password can then be searched for in the list of hashes \cite[pg. 52]{appcrypt}.

Another attack against hashes is the length extension attack. 

\subsection{Private Key Cryptography}
In private key cryptography, both users Alice and Bob who wish to communicate securely must have each others secret keys. The security of private key cryptography resides in the length of the key and Alice and Bob keeping the key secret. There are two main types of private key ciphers: stream and block ciphers. Stream ciphers encrypt a constant stream of bytes while clock ciphers encrypt plaintext in descrete chunks.

\subsection{Public Key Cryptography}
In public key cryptography each user has two keys, a private key $k_{pri}$ and a public key $k_{pub}$. $k_{pub}$ is used for encrypting messages, while $k_{pri}$ is used for decrypting messages. Unfortunately, every user must have a list of the public keys for all users they wish to communicate with.

When a user Alice wants to send a message to another user Bob, Alice encrypts the message with Bob's public key. Since Bob is the only one with his private key, he is the only one who can decrypt the message, thus providing secure communication if the algorithm is encryption and decryption algorithm is secure.

Typically, a public key algorithm such as RSA is slow and thus not very feasible fo the real time applications in use today. However, public key cryptography algorithms are commonly used to exchange a key for use with private key algorithms such as AES.

\subsubsection{Certificate Authorities}
A Certificate Authority (CA) solves the problem of keeping track of keys. Instead of having a key for every other person, the CA keeps them all and each user just has the key of the CA. When the user Alice wants to communicate with Bob, Alice asks the CA for Bob's key via a secure channel. Once Alice gets Bob's key, Alice then can communicate securely with Bob without involving the CA again.

\section{Attacks}

There are sevaral types of cryptanalytic attacks that can be performed on a cryptographic system \cite{diffiehellman}:
\begin{itemize}
	\item{\textit{ciphertext only attack}: The cryptanalyst knows only the cipher text}
	\item{\textit{known plaintext attack}: The cryptanalyst possesses a substantial quantity of corresponding plaintext and ciphertext}
	\item{\textit{chosen plaintext attack}: The cryptanalyst can submit an unlimited number of plaintext messages of their choosing and examine the resulting ciphertext}
\end{itemize}

\subsection{Man in the Middle Attacks}
If an attacker can observe and control all communications between two parties, they might be able to read or interfere with the conversation. For example, assume that Alice and Bob are trying to communicate and Mallory is in the middle and can control all their messages. When Alice sends Bob her public key, Mallory intercepts the key and replaces it with her public key. Then when Bob sends Alice his public key, Mallory intercepts it and replaces it with her public key. Now when either Bob or Alice send a message to each other, Mallory can read or alter the message \cite[pg. 48]{appcrypt}. An authentication step is needed in the key exchange algorithm to ensure that Bob is really talking to Alice and vice versa.

%references page
\newpage
\bibliographystyle{plain} % could also use ieeetr, acm or apalike
\bibliography{bib}

%appendices
\newpage
\appendix

\section{Frequency Analysis of Shift Cipher in Python 3}

\lstinputlisting[language=Python]{code/shift_analysis.py}

\newpage
\section{Frequency Analysis of Vigen\`{e}re Cipher in Python 3}

\lstinputlisting[language=Python]{code/vigenere_analysis.py}

\end{document}
